---
title: "Eficácia das vacinas"
subtitle: "Coronavac, Oxford e outras"
author: "Luiz F. P. Droubi"
date: '2021-01-13'
categories:
- covid
- estatistica
image:
  caption: ''
  focal_point: ''
slug: []
tags: 
authors: []
---

```{r,setup, include=FALSE, echo = FALSE}
knitr::opts_chunk$set(cache=FALSE, echo = TRUE, message = FALSE)
library(fitdistrplus)
library(appraiseR)
library(ggplot2)
library(mosaic)
library(personograph)
```

```{r}
coronavac <- data.frame(
  id = 1:(4653+4599),
  group = c(rep("vaccinated", 4653), rep("unvaccinated", 4599)),
  diagnosis = c(
    rep("mild", 7),
    rep("asymptomatic", 78),
    rep("abscence", (4653-78-7)),
    rep("serious", 7),
    rep("mild", 24),
    rep("asymptomatic", 129),
    rep("abscence", (4599-129-31-7))
  ))
coronavac$group <- factor(coronavac$group)
coronavac$diagnosis <- factor(coronavac$diagnosis, 
                              levels = c("abscence", "asymptomatic", "mild", 
                                         "serious", "death"))
```

Hoje vou me atrever a escrever aqui sobre a questão da eficácia das vacinas da 
COVID-19, inclusive a polêmica que está nascendo sobre a real eficácia da
Coronavac.

Primeiramente, nem é preciso dizer que não sou especialista no assunto. Mas vou
contar aqui o que eu andei lendo sobre, tentando traduzir para as pessoas leigas,
como eu, o que eu consegui depreender sobre o tema, tendo um pouquinho de 
conhecimento sobre probabilidade e estatística.

## O cálculo da eficácia

O cálculo da eficácia de uma vacina, segundo este [post](https://www.r-bloggers.com/2020/12/covid-19-vaccine-95-effective-it-doesnt-mean-what-you-think-it-means/),
é feito desta forma: um laboratório recruta um número razoável de pessoas e as 
distribui em dois grupos. Um grupo de pessoas que recebe a vacina, denominado 
grupo de teste e o outro grupo de pessoas recebe um placebo, isto é, uma injeção 
de soro fisiológico ou algo que o valha. Desta forma, a eficácia da vacina vai 
ser calculada comparando-se o número de pessoas que ficam doentes no grupo de 
testes em relação ao grupo de controle.

![](https://super.abril.com.br/wp-content/uploads/2021/01/Screen-Shot-2021-01-12-at-6.30.12-PM.png)

Foram calculadas diversas eficácias. A primeira eficácia diz respeito aos  
casos graves e moderados (que necessitam hospitalização). Foram identificados
7 casos moderados/graves no grupo de controle e nenhum no grupo de vacinados.
Logo, a eficácia em relação a casos graves/moderados é:

```{r}
(1 - (0/4653)/(7/4599))*100
```

Se além dos casos graves/moderados, a gente incluir também os casos leves, *i.e.*
aqueles casos que precisam de alguma assistência, temos:

```{r}
(1 - (7/4653)/(31/4599))*100
```

Chegando-se, portanto, a uma eficácia de 77,68% de eficácia. O Instituto 
Butantan divulgou, no entanto, uma eficácia de 77,96%. O que é estranho, 
já que as fórmulas para o cálculo da eficácia são muito simples e podem ser
verificadas [neste artigo](https://apps.who.int/iris/bitstream/handle/10665/264550/PMC2491112.pdf), no site da OMS, p. 100. 

Por fim, se incluem-se os dados de casos muito leves, com poucos sintomas ou 
assintomáticos (pessoas que testaram positivo sem apresentar quaisquer sintomas
da doença), temos:

```{r}
(1 - (85/4653)/(167/4599))*100
```

E chega-se a uma eficácia de 49,69%, enquanto o Instituto Butantã divulgou uma
eficácia de 50,38%.

Se eu estiver certo, os dados brutos podem ser resumidos na tabela abaixo:

```{r}
(tab <- table(coronavac$diagnosis, coronavac$group))
```

```{r}
knitr::kable(tab, digits = 2, 
             format.args = list(decimal.mark = ",", big.mark = "."))
```

Já nesta outra tabela podem ser vistos os dados em porcentagem:

```{r}
knitr::kable(prop.table(tab, margin = 2)*100, digits = 2, 
             format.args = list(decimal.mark = ",", big.mark = "."))
```

É muito simples de entender, não é? Não sei por qual motivo, no entanto, os 
cálculos do Butantan são diferentes. Isto significa que o Instito Butantan deve
abrir a sua metodologia.

Porém, é possível ver [neste relatório](https://www.cdc.gov/vaccines/acip/recs/grade/covid-19-pfizer-biontech-vaccine.html) que a vacina da Pfizer, por exemplo, nem se
preocupou em estudar a eficácia entre assintomáticos!

A vacina da Moderna, outra "top de linha", com 94% de eficácia em relação a
proteção à doença, [tem "apenas" 66,7% de eficácia em relação à presença do
vírus](https://healthpolicy-watch.news/vaccines-reduce-asymptomatic-transmission/).

É por este motivo que deveremos continuar a utilizar máscaras mesmo após a 
vacinação ainda por um tempo: ainda poderemos transmitir o vírus, apesar de 
vacinados, ainda que não desenvolvendo a doença.

Porém, para um resultado mais justo, deve ser levada em conta também a questão 
da eficácia dos testes. Afinal, se a eficácia da vacina é feita levando em 
conta o número de pessoas que testaram positivo, então presume-se que o teste
seja 100% eficaz, não é mesmo? 

Felizmente, não é bem assim que as coisas funcionam. Nenhum teste de laboratório
é 100% eficaz. Todos os testes podem falhar, por uma série de motivos, desde
o risco de contaminação na coleta do material, até a própria sensibilidade do
teste. É por isso que, no geral, devem ser testadas apenas aquelas pessoas que
possuem sintomas da doença. O diagnóstico médico é feito, então, em cima das 
duas evidências: primeiro, os sintomas; depois, o resultado do teste.

Senão, vamos ver o que pode acontecer: imagine que a sensibilidade do teste PCR
seja de 99% (muito bom, não é mesmo?)

O que isto significa? Que o erro do teste é desprezível? Vamos ver:

Segundo o Teorema de Bayes, a probabilidade de que uma pessoa, escolhida a esmo,
*i.e.*, assintomática, que tenha testado positivo para uma doença de fato seja
portadora da doença depende: da eficácia do teste e da prevalência da doença na
sociedade em geral. Ela pode ser calculada de acordo com o teorema de Bayes:

$$P(A|B) = \frac{P(B|A)P(B)}{P(A)}$$
Para o presente caso:

$$P(Estar\,doente|Teste\,positivo) = \frac{P(Teste\,positivo|Pessoa\,doente)P(Teste\,positivo)}{P(Pessoa\,doente)}$$
Em português: a probabilidade da pessoa estar doente dado que o teste resultou
positivo (estando assintomática) é igual a probabilidade do teste resultar
positivo dado que a pessoa realmente está doente vezes a probabilidade geral do
teste resultar positivo, dividido pela probabilidade total de uma pessoa
qualquer estar doente.






